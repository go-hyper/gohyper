<div class="gh-margin" ng-controller="OverviewController">

  <h3>All quotes</h3>

  <div class="row gh-search">
    <div class="col-md-offset-8 col-md-4">

      <div class="input-group">
        <div class="input-group-addon">
          <i class="fa fa-search"></i> Search for tag
        </div>
        <input type="text" class="form-control" placeholder="tag name" ng-model="searchInput" ng-keyup="$event.keyCode == 13 && searchFor(searchInput)">
      </div>

      <span>or</span>

      <div class="input-group">
        <div class="input-group-addon">
          <i class="fa fa-sort"></i>
          Sort by
        </div>
        <select class="form-control" ng-model="sortBy" ng-init="sortBy='default'">
          <option value="default">Time (newest first)</option>
          <option value="timestampOF">Time (oldest first)</option>
          <option value="quoteAZ">Quote (A-Z, a-z)</option>
          <option value="quoteZA">Quote (z-a, Z-A)</option>
        </select>
      </div>

    </div>
  </div>

  <table class="table table-striped">
    <thead>
      <tr>
        <th>Quote</th>
        <th>Links</th>
        <th>Comment</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <!--tr ng-repeat="quote in quotes | orderBy: '-quote'"-->
      <!-- TODO check what's more efficient (sorting here or in background) + check support for pagination -->
      <tr ng-repeat="quote in quotes">
        <td>
          <!-- http://stackoverflow.com/a/25892456/4419582 -->
          <p>"{{quote.quote | limitTo: 120}}{{quote.quote.length > 120 ? '...' : ''}}"</p>

          <p>{{quote.title | limitTo: 60}}{{quote.title.length > 60 ? '...' : ''}}</p>

          <p>
            <a target="_blank" href="{{quote.currentUrl}}" title="{{quote.currentUrl}}">
              {{quote.currentUrl | limitTo: 50}}{{quote.currentUrl.length > 50 ? '...' : ''}}
            </a>
          </p>

          <p>
            <span ng-repeat="tag in quote.tags">
              <span ng-if="tag.length > 60" class="label label-default gh-label" uib-tooltip="{{tag}}">
                {{tag | limitTo: 60}}...
              </span>
              <span ng-if="tag.length <= 60" class="label label-default gh-label">
                {{tag}}
              </span>
            </span>
          </p>

          <p>
            <small>
              {{quote.updateTimestamp | date: 'short'}}
            </small>
          </p>

        </td>

        <td>
          <div ng-repeat="link in quote.hyperlinks.slice(0, 10)">
            <a target="_blank" href="{{link}}" title="{{link}}">
              {{link | limitTo: 50}}{{link.length > 50 ? '...' : ''}}
            </a>
          </div>

          <div ng-if="quote.hyperlinks.length > 10">
            <a ng-show="!showMore" ng-click="showMore = !showMore" href="">Show more</a>

            <div ng-if="showMore" ng-repeat="link in quote.hyperlinks.slice(10, quote.hyperlinks.length)">
              <a target="_blank" href="{{link}}" title="{{link}}">
                {{link | limitTo: 50}}{{link.length > 50 ? '...' : ''}}
              </a>
            </div>

            <a ng-show="showMore" ng-click="showMore = !showMore" href="">Show less</a>
          </div>
        </td>

        <td>
          {{quote.comment | limitTo: 240}}{{quote.comment.length > 240 ? '...' : ''}}
        </td>

        <td>
          <a href="#/quote/edit/{{quote.id}}?page=all_quotes">
            <button type="button" class="btn btn-primary btn-xs gh-small-button">
              <i class="fa fa-pencil-square-o"></i> Edit
            </button>
          </a>
          <button type="button" class="btn btn-danger btn-xs gh-small-button" ng-click="deleteQuote(quote.id)">
            <i class="fa fa-times"></i> Remove
          </button>
        </td>

      </tr>
    </tbody>
  </table>

  <!--div class="text-center" ng-if="quotes.length > 50">
    <uib-pagination boundary-links="true" total-items="pagination.total" ng-model="pagination.page" class="pagination-sm" max-size="pagination.maxSize" boundary-links="true" rotate="false" num-pages="numPages"
    previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"></uib-pagination>
  </div-->

</div>
